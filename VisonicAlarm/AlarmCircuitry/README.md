Visonic have not provided a way of triggering the alarm through the serial connection (some bugs mean you can only sound the siren for about 3/5 seconds and I have done a LOT of testing through trial and error to rule out virtually all potential options). Hence if you want to trigger an alarm on the Powermax through this integration then you will need to set up a relay board like the diagrams below, and hence the Wemos pretends to be a wired zone of the Powermax (Zone 29 and Zone 30 are normally Wired zones on virtually all panels).

The diagram below shows two methods of doing this, the option below allows you to set up two different zones (which could have different meanings - fire and panic for example, or siren and non-siren alarm), while the option above allows you to trigger an alarm or a tamper event (potentially a tamper event could also be a silent alarm or trigger a different action/notification, and only works when armed). If you only have a single relay then the top diagram may be easier to follow with the grey wire connected, hence the green resistor is connected to the middle relay pin (where the purple and red wires meet - and you therefore dont need the red wire). Hope that makes sense!!!

In order to do this, you just need a few wires from the Wemos to relay board, and a few wires (plus two resistors) to connect to the Powermax. I suggest trying to find a similar 5V relay module since this one supports 3V3 on the Wemos connection pins (IN1 and IN2), but also 5V which is needed for the relay - this also includes an optoisolator which will help for preventing damage to the Wemos, and to ensure any voltage spikes remain separate.

When connected you should be able to go to IP_OF_WEMOS/alarm?method=12 in a web browser and hear the relay click, if not change 12 to 13 and repeat. (Pin 12 = D6, Pin 13 = D7). Once you have got this working in a web browser then you can configure Powermax to use this zone and SmartThings to trigger the right pin (D6 or D7).
1) For the Powermax, you need to go into installer mode to configure the new zone. I suggest setting the zone (29 or 30) to Fire / 24h Audible / 24h Silent as the key zone types (the 24h options are basically panic buttons) depending on what you want to happen when the relay is triggered. Once this is setup you should be able to visit the above web address and rather than hearing the relay click you should hear the alarm trigger!
2) In the SmartThings App on the Powermax device, click Settings. On this configuration page you should now choose the alarm trigger method and set it to D6 or D7 based on which pin on the Wemos is connected to the relay, and hence Powermax. It is better to work out which of D6/D7 you are using from the web link above, but you can do it by trial and error too. If you trigger D6 and it does nothing, or triggers a tamper, then swap to D7! Be aware SmartThings sometimes takes a while to update preferences (after you press save it takes time before the code sees this change), hence you might find that changing the pin has no effect - if this happens you need to wait a few hours for SmartThings to update in the background, and then it should start working.

Any questions or problems, I suggest asking on the SmartThings forum.

![Connections to Trigger an Alarm](AlarmTriggerConnections.jpg)
